packing_list_raw = """BdbzzddChsWrRFbzBrszbhWMLNJHLLLLHZtSLglFNZHLJH
nnfMwqpQTMffHlNNLllHnZSS
cGpcMwfppfqcjcTCBBzWDsDbDrjzWz
LhfjhcdjcGdhFfdGfdjdvwCCZMvvLvWwMLCLSwZC
rDnsbmptPmlbQMCrQWQQBZQW
gltgVPngDPbptPsbPzVgmDldfTdfczThjJJjfMcJdFHjjH
dGlgDflTLLLrRLTLVdQLcQMnbvHbbFzNNvMbnHHn
sZjWJJCSjWqfCqSjSmJSbFvCzBMBBzHncHNvMBHN
twqqwpZwfrlwRwDGDR
zCGGFTQMQrsNRNGZdR
cLLQgPDpgcgmvPRHrwBdvrNZ
glWpmJWQDcJpQnpjSmbhFtMnqFfCVTCFCFFM
zNZWFNZBFrGTdBcZZBdJTrGrmgvppgDHwHmgVHCHCvCPDjzC
qtqqPnLSfLwvjvvgvvqH
MtbLLLQbRfPRfnbnnLMtnsbdBNsrGWNWcNcTBWZrrcrWcJ
sZwstbbDVlHtbhcrhhZLrRpNQN
jqGjjFjWnzWGgqWjJJNphnLMRhLhcrhcrSLN
qCJzFJdvmHvbtpbb
ZSRsvvQvZpsRQGJghClPCwGPChCP
FVdMLDdtDRdDcBtmcVFntwgJJTlnNPwJnlTlwlTPgN
VqttMWFmDbjbzrSWRQ
TsDSBcwshdwSCrgRWZBvgGRG
LPVJLqqJbbzpFqwpbvgGRmZPrmZgCvCCfr
tzJlJzQllFLqtwHhjNSdtthjDhTN
fsDLDDnwvnSdqLSsFSDfsLpbgVttPMpPNjMWVMNfpjgW
jhHmBmlrTBBHRPVtMZbppNPPZB
JmTTrTmjRTJqSQQSFqQw
HPzZFgPFMCHJCcZMcDQGwpLqPLqppwhGvv
BrWRqbqRsTSTqNddrVrthLQVwnpwphnvnDnGvGDn
tSbBfsRbTfqjJqjCqm
pCqrqzmqZzrmCCvCJwJPBRwJBWBmwWBJ
VqbqbjFLFfSHnfctBwDdDFTwtRRTDF
LVcnbjHLSqHnhbSGGppCMMZMphpNrQ
PhTcTPsSPCMvvhhMRPttbNWfNsWFNfWWtpNw
rdQrDbJBVVjrBVdLjHHHWNWwfHtzzNtFpZZptppg
JJVGGdddjDjDJmdjGqqRSbPMTvcRlqnnMlvT
SqGfTrBlSrrrfGGQvCnqZhZmPPhvJh
LdVNwgsjdjHmjWwDsDpwsHWtnCnQQQQNnvCnbJZQbNbtZZ
DjssDHLLVppDssdLspswFLVjzfFMTfSBcTRcrFSBzBTzmGzr
JSJJqlldpJlcdVWMlgMJrcCjrhzHCwTjHrQzwTzZ
bBvsGBGNFDNRFNFBRDPsDDHCChhhrZRQQzhjhCjTzWCr
FvbLFGDDtWDFBnPGFDWGqJMgJpSdVStllttlppVS
clpBdBQBsqGpQbVdqTTWRTSFgLLggffg
NzvwmHvZtZZgbDSCLDmfmm
jPJjthHzNwPvvjwjNzPzztZBlrccpbVGBQhlGBVlrpnpBs
NmFFGlGmzCrNWHvFmFWCFvQPTdDDlbbdgJPtgbbdPDcc
RwfBqLwZqffqnPbdDgVQDdtRbT
hnptqLMMLwqjMMjzSzHmhvNNrvvhhz
hqVrDdPdVDqjsDrjjqsfrrWlctvHJNLfvNcLHNNZRNZHvfZL
CSnWQSGBBSnmBnTmSbQbNZZMJNJMccGNHLZNNvNv
gFnmBmBnTCpwmBbgWVqjPsrsjplVrjlqPr
vgVgJJCphzFjzbwljwww
PWmfDgrPrPWlSWqSWlSZ
rrTHQTGTPHDDHgPrcrcPmDPhdtGvnvNnttJCdJhtGVnpdM
DDDhNgWNLWgDqDgtgtwSngjVSQdf
cvFrcGmBrrrCdSfSJQ
mBHzFFvFzmsBspsFsZqhqbWlWdPDlLHbqZ
TLNpGpRzwGQLLQRTwdvWdWbdbgdBlblb
FJDVzZzHfZHVzcHgnvHnvngvvc
MzDVSmZPPrqhGmCqQqLR
mqHWcBHVcgsbhhnTrrTg
fWftGtfJpwJMSdFDLFSGDGFnnNrbrhTNsZnrhTswZZnnsb
dSftppdSFStLDpQfLjWHQvWBmmqVjCqcVv
frfNzgvzzzJwJqpRcP
VdVSnGnHqhDDTdqhdLWmjMTmjMPjPmTsmsmjmR
BdGLSWtBSWDtVqdSDVGqtSSHFZFZtQbZlZfNgFffrgNrvgrl
jBVSjsJcLcqqjtgcmRFRNFFzFm
CnHnWQQGGWnnCnfvCTmZRZgNtfZtNDZPtNDtzl
mWWGGdmQQWwrHHMBBBhrBVqshBLBSL
cLtFcllvrslGLcLHVzDZQzzpznWzQtQZ
TmShfSSPJRRBBfSgmdfBJhDNVpGzVZpzQgZgbWzpnDGp
BhJPfSqdhqJRdBdPqTJBChvrFlHvvCGCccHsMscvrHvv
zfddZTpZLzLDfLtDCttdTfZPnlcPcnhjPDnlcjMchDPjnP
MQsFvFHJsQvmNvvswljgbPbwlwjnmcch
VFVqvqFQHqVJRVCBLpqTGMzCqtMZ
PZdVgNdQQcdcZQtGhnHtBlvlvWTnbBHWWH
CDJmzqFmMmLfqmzFwqfzfwMRvpRbTWBBWDnlnbnWnTNTnB
zFfffjCqwLJCfrCFjCLCzCMsjSZjQNPhQGVSQQZhsGjGgd
nbHntnqPQwTHwQVC
BzfSZSpcBZpzpPhSBjRTCBWTTRWTTTWR
pvZpzPzNfhddJGmmNnJb
GwTgWlvbgTwMrbwTrlWvwtHBNtNvBhBtdZcShHDtNS
PnndmnCmnJFnsmRdmFnnZDhRRScRQQHDtDNtcDQS
CLffLsmqqpJljVdlpMpWlr
dPCzBLTSLqmqdSCsmrTDVQjZfjfVVZnZhhhLGQ
wwFpgvPJNwgPPwvZGnQhbZQQFfQZbf
WvRwwJpHHgpNMNqdTdCdqrmHBPtm
DbWwjSGFSFfwGfCwDSSPPjLhgrrLWRJRgggJphLzpJLq
lQTnMHdcQBvlHMMZBcHHTrbzpdzgqrpLdqzzVRVRVV
vlvlNlBQvBZTQBnHnQTTBBPwPNCCsfSFmbSFfmGPwFmj
hGGQtbVjhRqlmqqrmDlpmw
gPMZsMgdssCPPsvrgZcTZTPSnnLLnBWDwLmwWwBnmWSnWNWB
TsvgMPdcgCfMdcsZJRQhVfVRVQFFQGtr
NfpFTTpFNbpZMRFrJMMMCv
dWJPngDWBtPVBdPVGHZzCGHZrrvZRSMSzv
WDDDVDPlWnLBVgnsgJmQJNqThNmbjlqbbh
vnznqvfrzzVzrvvnfVqztBtGbMCdGmCcdccJccCLCcpSSgcL
RQsDsljDlhssWshHhlhsHTlLbgJLpmgbbcMSpSSbcSJgjd
WswhhHWlRTsQDwWHTRhsvNVvwqzfVmNBtZNmnzzq
cjcPfLlQtPsZQlfHZJqVSFdVwmSRRqSSddwDvF
MgNbBgzgnwdPRFmSPn
CMGbNNMhCMzzPzBpTNPGBclLcLfsptHQfQlZssLcLf
slsdfpSlllpTVJJGgGDgHMdV
wrBQrbQrhQcpbQrhLwRBrjVVgGGPgZMtZMVhgMPMGHPg
QQwRnrwRbbRcmQmrjRnjpvNsNTNSlTmsTqCSvsNSWz
GWNwppdHdpmzgPFPCRmlCBPB
bSrJhJSsMhrJMDPRCPBlwVCtVSLV
QbsbwqQZvrJhhQrhZZrhchTfnTWGNvWpNnjHGvGjNdGT
NMZGmnMBWmwmNnGwHrHvHzfrvrVVVj
pSbDRLgbpJDPpRZRQjjFqVhhDFjDVqfrzv
sQQscLTZcsTpRsBnmlBcdCMBMtlc
hwWslbGWbRvLZvcscZ
gQnmmrNTmSnTfgwDwVwpJvJPJzLqLJTLLvRcZz
mrmnSrDNNQSmmwdggrrDbHMGhtdtGhGlhtClMGhM
qQdlGcvDQDQvDdmtPmmmlStbjSrm
CpNhzWTCTRznBMvwtTjMrHtSvj
nWzsfZCsBhNpZLgGdQDddvqd
ggjTjJWDVVVRTwQcZWvchshWhs
LmFfLfSmBtCttNLfCFBPFNBvvvhrcQdvsrsdSwdqcwrwSw
CHttltmlPLMHRTgJQDgRDTMb
RPJgCdhgPPSzvWDcCfGHDcvf
HbrrwBspTwWDDnqbZjjD
rQrFsrsstQMQHJdHQm
GVwQVGBZBNQwsjdNcMMlgJNPgj
SWFfSzTCSWFCSpgnJLSjpMdc
FhTbvrzrMrDCVHsVsHGBtHwv
FsqjjVzFVWFqRRWBssdpNSBHwJpHHJJdddSN
lQgmhvbTcgTgfhTQhSCFCGJHSlwNtJdGHG
vgZPbbfMhbTmchhjRFRnsDRPWVqzWz
cvwfjjcJjqhctvSpCgCFVhrFCrpC
mRsQmsMlNNzznWQlRnsMRQlSCpLNbpwSSSrwFLDFLLLgFp
zznlnGlmRmMlPZnGQzMszMRfccTjcBJjtJtJjqTZtfwBTt
PtCwCCVqbjNNqqvGssPmHGsHMfPH
dcddcWFDJJJcLczhWQdcDScZvHZgpGfsvMfSmsggSvvnvM
TTQmTDhdQQzdRwjBVrRwCwBbBr
BnBsFHCrcnBrMBPSmMSCmrcFqnZLddLhdhdGLvqLqgqnLJJp
WfjTlNVDTtjzNWTlVMWNlTwTJphdgpvJLGLdgghZvGLpwddq
zVjbVblVDlNTlbzTzDjllDTzHmHCsmcMHcSBrCBbrHBcBPSC
ddlcGQlCjQNGQmPLslZTlmTtfT
MDzMwSwqpzpDRpWRJwgZhttrZmTPfZmrmtrMZZ
JSqRBpJzwgDDpqDqvpBRdCjbCjQCFCbHvdGPjdHQ
bwzPwGLZMsbJMPPLGLMQzbhhQRvWWtVqVhgCVtWWQDqt
HddrHFnFNpVnVLhnvLRV
NLdrFjHTBrrdjFSpFmNBmSfZMwZMJJfSffbwzwPbczbJ
QTWSzTTLwTfwflSNJRdvGlRGcNgJBl
FnmmqrqbBBgRbHGc
MFZqrCVCqmZCprspFZmnnMsDfzWzDwSfjSwPQPTLhffwBLwj
npfgFRTZRRnDZLdgRfRrrjcWzGpWGGGQrjjWpP
vblVbvSShhVzHWjzzlrPWG
bVwqvCBtShqBhCCtqhNqCJRTTBDFJJLnJgDRWFBnWg
nHDNQvgvnNZHDnsGcjfNTrTfVrfL
SRWFSBRLtSFqjTrVVcsVjTSG
BdBbRttWBdbdWdbppmZlLmgwHvgQvgLZ
PQRZlpDDptQSclBMGVBdhVFGBMpf
nnrsTCWjLJsnsSMShhGJfwffwV
vjzqsjqgSHbbtvHZ
DgFmbdSDZbPgLbDDmFwZwgLSfccGcGvnvvngsGGnsGMNWsWs
HqztHHhHVhHjhRRhJtCVBCfNprMWpcMMJfsvvMsGscpG
tjVtBVTBtHHqCRqtzQwTPSNdSwPTTbPFDdml
sbmBmHZbRRRmwBmsSjHzRjmSCNFLNLLQNQhFgtQLzNztlrff
MpqPPDPVnGqrJpcqqJpMVlgtlLFLChCgChCCQgCtCD
VdcVVJvdrVWHbwHWBSSBRb
tPDVBzzNSNdDSQpMQMTQJMMQMN
LqSWSmbsmfQTTGZMWGCW
cLjLcbrjqmvfqLbfmqLwDBBzSHPzlwzcdBlnnP
SbnHrGHSrrhHJBrrScDfcPDMfpPGcGcpDL
QTpmpmmQWlZsTvVQDMgggFLgFcPf
zsCNlltCslzlTNsNlShwdJCpSqdHrBhpwr
JZmFrmLGjFZdDGrrVTvzmPVvRRVzwzzl
WBnfMDBqMsgDBqpBvzwVlCwRTRRPpvlw
WfghfttggfSnnqbDftfqSBBDQdHhZFFJrrHFjGJdGjFrjQLj
rNLRjrlVlrFRJzlsjrVlRFGCmnMtftgCNDDgDmCfqNgPNM
SpdBpdHbpHWhZqnCdtCGggqCPn
QHHvvWwWhwVVQRscVzGl
QffLtMQGMQfDMMwMTJwqWHvH
nSSFznjFcfjTgVJTJjvT
RrBpcfSNpRBcFshrCtQrDGLPQb
GctcMldStGwPPbcLsQTV
jhnzDgnHnnfPVwHQTTLTds
gBgzDDhzvqdGGvrtdvtm
PPwRWVTvRvPVLwRpMlzmbmsbHWjbbs
dFTFCNfdjzjFjsMF
SgdffSTrnnqCgdqgcNrfSZqVvVLRDPJZQwJBLPQPtLZwJJ
HSzDQftHphTBHFhr
WMmJsMJNLWNPmmsncjMJcjtvwggVvhFFFhjrVwrjrjppvT
WWPsJJCWCtZZZRGC
SfFZQDRLgpLlRgQRRRFWTsbhBhgTjbWBjhshgw
tHVNGjtzzHvMMJJhrWJNrTrPbP
jvVVvGCGtCmjHtdHzQQfDpSSlDRnFfQFmR
ZBBPfVVPPrVmrWZJzNdPznbnbSzznP
gvgpGqFFMgMcGgwLwGpcJNZSTZbdbdzNNSlqbTnn
ssZLgsMLQvcFpVrhCsmtWHjrrW
nFvhRnWWzBRPHQqcqqCqmFbd
SJDJgVprLfDfbJmHmWWHQtJW
wVsgWVSTgLjfSsVjVBRvRNwwGGRhNZhRMZ
wTRrRBCTPTBPlgMqgHCqggHLgg
dmDzpQpBdmWmWzzzDFzjGNMSWLSgLVGGLVNSLgSg
JbFdmQQJpjpptQbdJJmDmdtnZhZRflTlnTrTlrhBwPPc
jwSwssQbwbStlhRgtsVstn
zPzFdFFZccPDgntzVHHgghRz
vVVdfFmZPDMWZZBmGQbwJJGCLwwMwJCS
PLLffLFqqNLwSffbnVzzRf
lsmgTggChrgDtZsZVblMVJMznVnwMBnb
hDZZTmZvhTgstvwNFdqpWQcqvP
mmWwpwqtmmHTqHpprRZQPPZLZWSFRFRB
gzcgscgbfvhRRNZQRRQPvr
JsjhcshCfJgrrpttTCTplH
TvNrvNrJfWWvtJLTHhvZZhQQwVGZZhbV
mFCPmBMPlPsPPBsMFPszbHQJwwHHhbZVQVzjhGHZ
qmlBsdCSmJBmsBBMnMMTDWDNcLrDprSNcWDNrW
HSnHCVqTddFHSVqFqdStSQGQwRzQCzCRzGRRGNPQwz
jhlBpgNvlfZjlfvmpgfgfBrMRRwMMPPLQMZRPMWMMZPQ
hflfpgjfBfDcpchlpvndbHFDdHqSqNVqNVdn
QBfhlVNfHSZHfVCVHSQfZfTCctdvdDTRtjDCtTRsjsvj
brrWWqzFWzwWbswDchhTRtDhjT
gbrFLnpzqrWPgqpLWrhnHGZlSfLfHfQBGVfHHNVG
hcFmVScmQBVhtcvfHLfvHSnbHRLn
lzQqlDqgpWPvJfRnlNJvww
PjCCCPgDgqGzmMtCQstZmBFs
GrnrHrmVVFMFhSSbSfhR
zjTqLtBjjdWdWTLshMZMDbPNRMSSqSPNfD
dTWjdtwWhjWTBzcnrpcwmQpCwcpw
BgtVBsgVVJhgGsSGJbghJqbsjLfZmLjmmtfZndNNZFFZNLdm
MHTlzlwHSvPvzMSPCTMQCNZdjjmnfQjdZfNLjF
HMDTwPDpzrTzpScBghDbVqRBgRBJsR
qjCsTmrrnnCmhcFrCjqmThRlbHGvJGvvvbRbbJRcQJRG
fVBBTfMdSZLNZgPdgglGRdbtbtJRllJWJtWb
TSZZSpNMPBLgpZLVgppBDFhzDmjrnzhjssFqDhzFnn
MDtDMWmMQmdzmMMqvlGfRcjzgpcPPjczPl
sZsHJWNJFJNbWFBhFBnnbVclbVVPglfcRggffGGpjl
srHWLNZZJdSLSdvDMw
BFqsPnsZcgnncggccqsqqpDPtDWPpPNTNSNThrWtSj
dQbfQQJJdwdmFRbJLRJdMrfDWrjpDrrprhDDDDNWWD
QGwdJmCFJZvGsvvncB
GRRNSjrffGTSPrNTffSgcJTwWJZbbZvwvwtVwWVJZv
CMcFsqmBQzMzshsBQBQvLWmJVwZtpJLJwJLvwt
qBzChnQlzMcRSnnRRjHGGg
dPPbPWNdTBbDpHPHpNsgzvFlglvHzvSFzCFF
fntqhGhRMhnnnGGCVMRhCVlSjswFvvjzjSzvQVSgsl
MMqqJJRCnMhZLCRhtPNrpZPDDWTDTrNBmD
VjVGNTNlNchVjNGRWrSWWtZtRrzncR
BTbbbwDmCDLTbDwfHmzZMmRrWtzPrZSZtrrz
qDLLqvwLBsfBbBdQFQTJhqThVTQJ
qBqPBGZflhrWznzZZdsnzv
FmHRcCCsCDwDbjtzdjWbdz
cTRwCCNHFNmwRgmFTNCFTJqqfqPJsPhPBlsrsfGf
JTNhhNrCTcWpJJcpWw
LLdLsfMsdStbtggLbnTpwfWDzpjvnnjzcz
MqSZsgbMbGFbZtgTSZSFSLhhmHlBQlmrmrPHHCPPZPBr
GgjjgpGvpJJtjgvPrJttsLjVwCsQsQNLsfLfMVCl
RddqZqzcZdSWcHdcqQfQLMwVflfNQNMQ
FncWTRcFlHWFmcFTgPJhGvDgpnnhhGtG
ZGPFJsPQCbZCCbgz
nrvrnGWTwwqTBRcpCRRg
DnGWDldNmSLSMdMQ
ScDmPPPmjmjjWgtdSmdmCnNqVQVVrNRTZTQTQDHHZGNH
wbbMhLvMJpRwJQrJGHqQGrQHqr
wzhspwpppswsMFLmtnzjdcmdPRWPtS
fPlLTtBlTjDbWcTMJcncWqss
LdvLrLpCRRQQmvhhVNpwRMWJZcFMZWJwJFFFwZsGcs
prrRVpvvRVNmRvvzHjHPlzPLSffbbPHS
bbCbzsQbBzbBFbFzFfJHfVJPfVPtzZttpm
hwvrjDDwjcDcvdnNvwdnwwDPpNtNMVtPpJpRmVMPfmtVZR
mmqDWjhcqhwvDDdTsSGGCbQGSBBLTGGl
wthtwrBQhhSrqJJVLMRPPtJLPF
vbmbZqfqgsfHmcllmLLJNLJMNFJNNvPGJn
jHlDscllClCCgbZzhWqBzBQzprWCqS
DwpDlwDwllhJwbDFNDwFPhDnQnZZzVVnnBrtNznzSSzZrr
MHPfWRTgWzTQmSTTZt
GdPjHLRMCfcGvwqDGbFq
NGdNpDPdNGLppLpwSNFFFDLwnnZbMnrHlHZQcHbcnHQcPcQM
jBgBsjssgjWJVGhBfhvJVnMlbnZQVrrrlHCcCZrl
sRBgvRffhhtvtBgvjgttWBJTLmFLLwdwzFdqLDDDqFGdLFTd
RBzRGRGBgnrPJrRGGWWbDggZTSTVZVFFSVZZdw
tfmLhjfshNNsqpppfjHdwVdQZbVbQFVVTmSVDV
jvqtwHqCNLNsNhNfjssLCzGJWcBRJRBCBBBrrWnGrG
cGDBdNFdNdDStNtGdGQGscDMvZjjZWMvMLjsjjLZjLsJLv
fbRnRzHVPClfRlbbmfHRlPvZvMLpqjvZJqZMpzMpZjBZ
gfbfBgCHCPVNhNGgTtFDcF
ljjvLZvvllFnlLJLJjLWFQrVssFpsGMFpNMGsr
qbHSqHTcHChqCmTSRqqBVpVdBQsVQQGHdMprWV
DbtcCqRhhTRmDnPMlLgfgztlZZ
QtMQzPZcbtGgTtLvtf
HwcDsdVVDnNSGLhwvffJvfTT
CSsdSHNmSDHcCqqcrrzQcC
nDNDfmMnmDJRNfJJdMDRBdwjcTtsSHvBTswTjwLtsCts
QcbQrZZggGWVVWbZZjStswCSCCttGCwLvC
ZgZgbzVglVbchVVrVhFWWpnnpNJmJMqDfMJnMRqNDDMD
WMfNvsjWGjsqFjqTRRQVJztDzVmJHbft
ZPhplcrLrmzQGzmz
ZPddLPlcSclhZChndMvgTjjWNGWMGWBj
nDLjMchghDcljfjffpfsqTmGCTGszGZVVzHV
wdFJPFrQRwSNbjVQCTGsHZHmHCHs
BRJJSddvdBrJwrBRNRFRSPRjvclLpWhpglgWpLplltnMgh
BbVRzMcpbMNMHMTJmWdljdlJjT
GtsqFnfvGSFqGfQvgnWWZlLlLjZWtWldPmlT
sSsFqsqsGghwQQmfGRHbbVczbwwBpBpHcw
BBFCBJCsGJBBgvgsvTlVhgNg
ZnLdjRQddLRnZrlScHRVTTSHhRvg
fnnjZLWdrnqdWrrPLddqVqBzGDJJFGCBDfJmbDzFMbmB"""

using DataFrames
using Pipe

function split_at_midpoint(payload::AbstractString)
    @assert mod(length(payload), 2) == 0
    midpoint = length(payload) ÷ 2
    return tuple(payload[1:midpoint], payload[(midpoint+1):end])
end

function pack(payload)
    dict = Dict{Int8,Int64}()
    for char in payload
        if char in 'a':'z'
            priority = char - 'a' + 1
        elseif char in 'A':'Z'
            priority = char - 'A' + 27
        else
            priority = 0
        end
        dict[priority] = 1 + get(dict, priority, 0)
    end
    dict
end

packing_list = @pipe packing_list_raw |>
      split(_, "\n") |>
      DataFrame(:pack => _) |>
      transform(_, :pack => ByRow(split_at_midpoint) => Symbol.("compartment", 1:2)) |>
      transform(
          _,
          Cols(startswith("compartment")) .=> ByRow(pack) => Symbol.("inventory", 1:2),
      ) |>
      transform(
          _,
          Symbol.("inventory", 1:2) =>
              ByRow((i1, i2) -> intersect(keys(i1), keys(i2))) => :duplicated,
      ) |>
      transform(_, :duplicated => ByRow(sum) => :priority_sum)

# a
combine(packing_list, :priority_sum => sum => :priority_sum)

packing_list2 = @pipe packing_list |>
      select(_, :pack) |>
      transform(
          _,
          :pack => (pack -> repeat(1:100, inner = 3)) => :id_group,
          :pack => ByRow(keys ∘ pack) => :dedup_priorities,
      )

badges = @pipe packing_list2 |>
      groupby(_, :id_group) |>
      combine(
          _,
          :dedup_priorities => (x -> sum(reduce(intersect, x))) => :badge_priority,
      ) |>
      combine(_, :badge_priority => sum)
|>
transform(_)
